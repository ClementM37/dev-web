{% extends "base.html" %}

{% block main %}
    <h1>Recherche de livres par auteur</h1>

    <!-- Formulaire de recherche -->
    <form method="GET" action="{{ url_for('livresParAuteur') }}" class="mb-4">
        <div class="form-group">
            <label for="nomAuteur">Nom de l’auteur :</label>
            <input type="text" id="nomAuteur" name="nomAuteur" class="form-control"
                   placeholder="Ex : Hugo" value="{{ request.args.get('nomAuteur', '') }}">
        </div>
        <button type="submit" class="btn btn-primary mt-2">Rechercher</button>
    </form>

    {% if livres is not none %}
        <h2>Résultats</h2>
        <p>Nombre de livres : {{ livres|length }}</p>

        {% if livres|length == 0 %}
            <p>Aucun livre trouvé pour cet auteur.</p>
        {% else %}
            <table class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Titre</th>
                        <th>Prix</th>
                        <th>Url</th>
                        <th>Première Couverture</th>
                        <th>Auteur</th>
                        <th>Actions possibles</th>
                    </tr>
                </thead>
                <tbody>
                    {% for unLivre in livres %}
                        <tr>
                            <td>{{ unLivre.idL }}</td>
                            <td>{{ unLivre.Titre }}</td>
                            <td>{{ unLivre.Prix }}</td>
                            <td><a href="{{ unLivre.Url }}" target="_blank">{{ unLivre.Url }}</a></td>
                            <td>
                                <img src="{{ url_for('static', filename='images/images/' ~ unLivre.Img) }}" 
                                     alt="Couverture" style="max-height: 100px;">
                            </td>
                            <td>{{ unLivre.auteur.Nom }}</td>
                            <td>
                                <div class="task-controls">
                                    <a href="{{ url_for('viewLivre', idL=unLivre.idL) }}" class="btn btn-info">
                                        Voir <i class="fas fa-eye"></i>
                                    </a>
                                    {% if current_user.is_authenticated %}
                                        <a href="{{ url_for('updateLivre', idL=unLivre.idL) }}" class="btn btn-warning">
                                            Éditer <i class="fas fa-pen"></i>
                                        </a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    {% endif %}
{% endblock %}
